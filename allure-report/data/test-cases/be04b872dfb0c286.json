{"uid":"be04b872dfb0c286","name":"test_05_create_connection","fullName":"tests.AddConnectionStandalone#test_05_create_connection","historyId":"dfadf4839d14100653795b75c968ad9a","time":{"start":1767003344101,"stop":1767003394727,"duration":50626},"description":"Test Script 5: Login + Create Complete Connection","descriptionHtml":"<p>Test Script 5: Login + Create Complete Connection</p>\n","status":"broken","statusMessage":"OSError: pytest: reading from stdin while output is captured!  Consider using `-s`.","statusTrace":"def test_05_create_connection():\n        \"\"\"Test Script 5: Login + Create Complete Connection\"\"\"\n        from playwright.sync_api import sync_playwright\n        import time\n    \n        with sync_playwright() as p:\n            browser = p.chromium.launch(headless=False, slow_mo=800)\n            page = browser.new_page()\n    \n            try:\n                print(\"=\" * 70)\n                print(\"TEST 5: CREATE NEW CONNECTION\")\n                print(\"=\" * 70)\n    \n                connection_name = \"PerrylHealth\"\n    \n                # Login\n                print(\"\\n[Step 1] Login...\")\n                page.goto(\"https://demo.ehrconnect.healthconnect.systems/login\")\n                page.wait_for_load_state(\"networkidle\")\n                page.fill(\"#username\", \"administrator\")\n                page.fill(\"#password\", \"Mindbowser@123\")\n                try:\n                    page.click(\"button[type='submit']\")\n                except:\n                    page.click(\"button\")\n                page.wait_for_timeout(3000)\n                print(\"✅ Logged in\")\n    \n                # Navigate and Add Connection\n                print(\"\\n[Step 2] Navigate to Connections and click Add...\")\n                try:\n                    page.click(\"text=Connections\")\n                except:\n                    page.click(\"a:has-text('Connections')\")\n                page.wait_for_timeout(2000)\n    \n                add_selectors = [\"button:has-text('Add Connection')\", \"button:has-text('Add')\"]\n                for selector in add_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n                print(\"✅ Add Connection form opened\")\n    \n                # Select Epic and Standalone\n                print(\"\\n[Step 3] Select Epic and Standalone...\")\n                epic_selectors = [\"text=Epic\", \"label:has-text('Epic')\"]\n                for selector in epic_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n    \n                # Standalone selection\n                try:\n                    labels = page.locator(\"label\").all()\n                    for label in labels:\n                        text = label.text_content().strip().lower()\n                        if \"standalone\" in text and \"embed\" not in text:\n                            label.click()\n                            break\n                except:\n                    pass\n    \n                page.wait_for_timeout(2000)\n                launch_selectors = [\"button:has-text('Launch')\", \"button:has-text('Continue')\"]\n                for selector in launch_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(3000)\n                print(\"✅ Epic Standalone selected\")\n    \n                # Fill Connection Details\n                print(\"\\n[Step 4] Filling connection details...\")\n    \n                # Connection Name\n                name_selectors = [\"input[name='name']\", \"input[name='connectionName']\"]\n                for selector in name_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(connection_name)\n                            print(f\"✅ Connection Name: {connection_name}\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Client ID\n                client_id_selectors = [\"input[name='clientId']\", \"input[placeholder*='client id' i]\"]\n                for selector in client_id_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"test-client-12345\")\n                            print(\"✅ Client ID filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Client Secret\n                client_secret_selectors = [\"input[name='clientSecret']\", \"input[type='password']\"]\n                for selector in client_secret_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"test-secret-67890\")\n                            print(\"✅ Client Secret filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Base URL\n                url_selectors = [\"input[name='url']\", \"input[name='baseUrl']\"]\n                for selector in url_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"https://r4.smarthealthit.org/\")\n                            print(\"✅ Base URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Click Auto-detect Button\n                print(\"✅ Clicking Auto-detect button...\")\n                auto_detect_selectors = [\n                    \"button:has-text('Auto-detect')\",\n                    \"button:has-text('Auto Detect')\",\n                    \"button:has-text('Detect')\",\n                    \"button:has-text('Auto-Discovery')\",\n                    \"[aria-label*='auto-detect' i]\",\n                    \"button[title*='auto-detect' i]\"\n                ]\n    \n                auto_detect_clicked = False\n                for selector in auto_detect_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.click()\n                            print(\"✅ Auto-detect button clicked\")\n                            print(\"⏳ Waiting for auto-detection to complete...\")\n                            auto_detect_clicked = True\n                            page.wait_for_timeout(3000)  # Wait for auto-detection\n                            break\n                    except:\n                        continue\n    \n                if not auto_detect_clicked:\n                    print(\"⚠️ Auto-detect button not found (may not be available)\")\n                    print(\"   Continuing to fill fields manually...\")\n                else:\n                    print(\"✅ Auto-detection completed\")\n    \n                page.wait_for_timeout(1000)\n    \n                # OAuth Authorization URL\n                auth_url = \"https://launch.smarthealthit.org/v/r4/sim/WzIsIiIsIiIsIkFVVE8iLDAsMCwwLCIiLCIiLCIiLCIiLCJhdXRoX2ludmFsaWRfY2xpZW50X2lkIiwiIiwiIiwwLDEsIiJd/auth/authorize\"\n                auth_selectors = [\"input[name='authorizationUrl']\", \"input[placeholder*='authorization' i]\"]\n                for selector in auth_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(auth_url)\n                            print(\"✅ OAuth Authorization URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # OAuth Token URL\n                token_selectors = [\"input[name='tokenUrl']\", \"input[placeholder*='token' i]\"]\n                for selector in token_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"https://bulk-data.smarthealthit.org/auth/token\")\n                            print(\"✅ OAuth Token URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # OAuth Scopes\n                scope_selectors = [\"input[name='scopes']\", \"textarea[name='scopes']\"]\n                for selector in scope_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"openid profile fhirUser launch launch/patient\")\n                            print(\"✅ OAuth Scopes filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Return URL\n                return_selectors = [\"input[name='returnUrl']\", \"input[name='embeddedAppUrl']\"]\n                for selector in return_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"http://localhost:5173/integrations/add\")\n                            print(\"✅ Return URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n    \n                # Create Connection\n                print(\"\\n[Step 5] Creating connection...\")\n                create_selectors = [\"button:has-text('Create Connection')\", \"button:has-text('Create')\", \"button:has-text('Save')\"]\n                for selector in create_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        print(\"✅ Create button clicked\")\n                        break\n                    except:\n                        continue\n    \n                page.wait_for_timeout(4000)\n                page.screenshot(path=\"test_05_connection_created.png\", full_page=True)\n                print(\"\\n\uD83D\uDCF8 Screenshot saved: test_05_connection_created.png\")\n    \n                print(\"\\n\" + \"=\" * 70)\n                print(\"✅ TEST 5 COMPLETED\")\n                print(f\"✅ Connection Created: {connection_name}\")\n                print(\"=\" * 70)\n    \n            finally:\n>               input(\"\\nPress Enter to close browser...\")\n\ntests/AddConnectionStandalone.py:234: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.capture.DontReadFromInput object at 0x112683770>, size = -1\n\n    def read(self, size: int = -1) -> str:\n>       raise OSError(\n            \"pytest: reading from stdin while output is captured!  Consider using `-s`.\"\n        )\nE       OSError: pytest: reading from stdin while output is captured!  Consider using `-s`.\n\n.venv/lib/python3.14/site-packages/_pytest/capture.py:229: OSError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[],"testStage":{"description":"Test Script 5: Login + Create Complete Connection","status":"broken","statusMessage":"OSError: pytest: reading from stdin while output is captured!  Consider using `-s`.","statusTrace":"def test_05_create_connection():\n        \"\"\"Test Script 5: Login + Create Complete Connection\"\"\"\n        from playwright.sync_api import sync_playwright\n        import time\n    \n        with sync_playwright() as p:\n            browser = p.chromium.launch(headless=False, slow_mo=800)\n            page = browser.new_page()\n    \n            try:\n                print(\"=\" * 70)\n                print(\"TEST 5: CREATE NEW CONNECTION\")\n                print(\"=\" * 70)\n    \n                connection_name = \"PerrylHealth\"\n    \n                # Login\n                print(\"\\n[Step 1] Login...\")\n                page.goto(\"https://demo.ehrconnect.healthconnect.systems/login\")\n                page.wait_for_load_state(\"networkidle\")\n                page.fill(\"#username\", \"administrator\")\n                page.fill(\"#password\", \"Mindbowser@123\")\n                try:\n                    page.click(\"button[type='submit']\")\n                except:\n                    page.click(\"button\")\n                page.wait_for_timeout(3000)\n                print(\"✅ Logged in\")\n    \n                # Navigate and Add Connection\n                print(\"\\n[Step 2] Navigate to Connections and click Add...\")\n                try:\n                    page.click(\"text=Connections\")\n                except:\n                    page.click(\"a:has-text('Connections')\")\n                page.wait_for_timeout(2000)\n    \n                add_selectors = [\"button:has-text('Add Connection')\", \"button:has-text('Add')\"]\n                for selector in add_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n                print(\"✅ Add Connection form opened\")\n    \n                # Select Epic and Standalone\n                print(\"\\n[Step 3] Select Epic and Standalone...\")\n                epic_selectors = [\"text=Epic\", \"label:has-text('Epic')\"]\n                for selector in epic_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n    \n                # Standalone selection\n                try:\n                    labels = page.locator(\"label\").all()\n                    for label in labels:\n                        text = label.text_content().strip().lower()\n                        if \"standalone\" in text and \"embed\" not in text:\n                            label.click()\n                            break\n                except:\n                    pass\n    \n                page.wait_for_timeout(2000)\n                launch_selectors = [\"button:has-text('Launch')\", \"button:has-text('Continue')\"]\n                for selector in launch_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        break\n                    except:\n                        continue\n                page.wait_for_timeout(3000)\n                print(\"✅ Epic Standalone selected\")\n    \n                # Fill Connection Details\n                print(\"\\n[Step 4] Filling connection details...\")\n    \n                # Connection Name\n                name_selectors = [\"input[name='name']\", \"input[name='connectionName']\"]\n                for selector in name_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(connection_name)\n                            print(f\"✅ Connection Name: {connection_name}\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Client ID\n                client_id_selectors = [\"input[name='clientId']\", \"input[placeholder*='client id' i]\"]\n                for selector in client_id_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"test-client-12345\")\n                            print(\"✅ Client ID filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Client Secret\n                client_secret_selectors = [\"input[name='clientSecret']\", \"input[type='password']\"]\n                for selector in client_secret_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"test-secret-67890\")\n                            print(\"✅ Client Secret filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Base URL\n                url_selectors = [\"input[name='url']\", \"input[name='baseUrl']\"]\n                for selector in url_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"https://r4.smarthealthit.org/\")\n                            print(\"✅ Base URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Click Auto-detect Button\n                print(\"✅ Clicking Auto-detect button...\")\n                auto_detect_selectors = [\n                    \"button:has-text('Auto-detect')\",\n                    \"button:has-text('Auto Detect')\",\n                    \"button:has-text('Detect')\",\n                    \"button:has-text('Auto-Discovery')\",\n                    \"[aria-label*='auto-detect' i]\",\n                    \"button[title*='auto-detect' i]\"\n                ]\n    \n                auto_detect_clicked = False\n                for selector in auto_detect_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.click()\n                            print(\"✅ Auto-detect button clicked\")\n                            print(\"⏳ Waiting for auto-detection to complete...\")\n                            auto_detect_clicked = True\n                            page.wait_for_timeout(3000)  # Wait for auto-detection\n                            break\n                    except:\n                        continue\n    \n                if not auto_detect_clicked:\n                    print(\"⚠️ Auto-detect button not found (may not be available)\")\n                    print(\"   Continuing to fill fields manually...\")\n                else:\n                    print(\"✅ Auto-detection completed\")\n    \n                page.wait_for_timeout(1000)\n    \n                # OAuth Authorization URL\n                auth_url = \"https://launch.smarthealthit.org/v/r4/sim/WzIsIiIsIiIsIkFVVE8iLDAsMCwwLCIiLCIiLCIiLCIiLCJhdXRoX2ludmFsaWRfY2xpZW50X2lkIiwiIiwiIiwwLDEsIiJd/auth/authorize\"\n                auth_selectors = [\"input[name='authorizationUrl']\", \"input[placeholder*='authorization' i]\"]\n                for selector in auth_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(auth_url)\n                            print(\"✅ OAuth Authorization URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # OAuth Token URL\n                token_selectors = [\"input[name='tokenUrl']\", \"input[placeholder*='token' i]\"]\n                for selector in token_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"https://bulk-data.smarthealthit.org/auth/token\")\n                            print(\"✅ OAuth Token URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # OAuth Scopes\n                scope_selectors = [\"input[name='scopes']\", \"textarea[name='scopes']\"]\n                for selector in scope_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"openid profile fhirUser launch launch/patient\")\n                            print(\"✅ OAuth Scopes filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(1000)\n    \n                # Return URL\n                return_selectors = [\"input[name='returnUrl']\", \"input[name='embeddedAppUrl']\"]\n                for selector in return_selectors:\n                    try:\n                        if page.locator(selector).count() > 0:\n                            page.locator(selector).first.fill(\"http://localhost:5173/integrations/add\")\n                            print(\"✅ Return URL filled\")\n                            break\n                    except:\n                        continue\n                page.wait_for_timeout(2000)\n    \n                # Create Connection\n                print(\"\\n[Step 5] Creating connection...\")\n                create_selectors = [\"button:has-text('Create Connection')\", \"button:has-text('Create')\", \"button:has-text('Save')\"]\n                for selector in create_selectors:\n                    try:\n                        page.click(selector, timeout=2000)\n                        print(\"✅ Create button clicked\")\n                        break\n                    except:\n                        continue\n    \n                page.wait_for_timeout(4000)\n                page.screenshot(path=\"test_05_connection_created.png\", full_page=True)\n                print(\"\\n\uD83D\uDCF8 Screenshot saved: test_05_connection_created.png\")\n    \n                print(\"\\n\" + \"=\" * 70)\n                print(\"✅ TEST 5 COMPLETED\")\n                print(f\"✅ Connection Created: {connection_name}\")\n                print(\"=\" * 70)\n    \n            finally:\n>               input(\"\\nPress Enter to close browser...\")\n\ntests/AddConnectionStandalone.py:234: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <_pytest.capture.DontReadFromInput object at 0x112683770>, size = -1\n\n    def read(self, size: int = -1) -> str:\n>       raise OSError(\n            \"pytest: reading from stdin while output is captured!  Consider using `-s`.\"\n        )\nE       OSError: pytest: reading from stdin while output is captured!  Consider using `-s`.\n\n.venv/lib/python3.14/site-packages/_pytest/capture.py:229: OSError","steps":[],"attachments":[{"uid":"1f4e70c4a0b9e1d1","name":"stdout","source":"1f4e70c4a0b9e1d1.txt","type":"text/plain","size":1035}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":true,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"AddConnectionStandalone"},{"name":"host","value":"mblt1082"},{"name":"thread","value":"14027-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.AddConnectionStandalone"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":[]},"source":"be04b872dfb0c286.json","parameterValues":[]}